# helm/demo-app/values.yaml


image:
  repository: gradyent/tech-interview
  tag: latest
  pullPolicy: Always

replicaCount: 2

service:
  type: ClusterIP  # Changed from LoadBalancer to work with Ingress
  port: 80
  targetPort: 8080

# Ingress configuration (bonus points!)
ingress:
  enabled: true
  className: "alb"  # AWS Load Balancer Controller
  annotations:
    alb.ingress.kubernetes.io/scheme: internet-facing
    alb.ingress.kubernetes.io/target-type: ip
    alb.ingress.kubernetes.io/listen-ports: '[{"HTTP": 80}]'
    alb.ingress.kubernetes.io/healthcheck-path: "/"
    alb.ingress.kubernetes.io/healthcheck-protocol: HTTP
  hosts:
    - host: ""  # Will use ALB DNS name
      paths:
        - path: /
          pathType: Prefix
  tls: []  # Can be extended for SSL

# Auto-scaling configuration
autoscaling:
  enabled: true
  minReplicas: 2
  maxReplicas: 10
  targetCPUUtilizationPercentage: 70

# Resource management
resources:
  limits:
    cpu: 500m
    memory: 512Mi
  requests:
    cpu: 100m
    memory: 128Mi

# Health checks - EXACTLY as required
healthCheck:
  readiness:
    path: /
    port: 8080
    initialDelaySeconds: 10
    periodSeconds: 10
  liveness:
    path: /hello
    port: 8080
    initialDelaySeconds: 30
    periodSeconds: 10

# Security
securityContext:
  runAsNonRoot: true
  runAsUser: 1000
  allowPrivilegeEscalation: false

# Service account
serviceAccount:
  create: true
  name: ""